<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Genel Çekim Takip - ÜçDörtBeş All Star</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* bg-slate-50 */
        }
        .collapsible-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-out;
        }
        .searchable-select-container {
            position: relative;
        }
        #table-container {
            max-height: 800px;
            overflow-y: auto;
        }
        .searchable-select-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            z-index: 50;
            max-height: 200px;
            overflow-y: auto;
        }
        .pagination-button {
            padding: 0.5rem 0.75rem;
            border: 1px solid #d1d5db;
            background-color: white;
            color: #374151;
            border-radius: 0.375rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        .pagination-button:hover:not(:disabled) {
            background-color: #f3f4f6;
        }
        .pagination-button.active {
            background-color: #4f46e5;
            color: white;
            border-color: #4f46e5;
        }
        .pagination-button:disabled {
            cursor: not-allowed;
            opacity: 0.5;
        }
        /* Bildirim Stilleri */
        .notification {
            position: fixed;
            top: 1.25rem;
            right: 1.25rem;
            padding: 1rem;
            border-radius: 0.5rem;
            color: white;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            z-index: 100;
            opacity: 0;
            transform: translateX(100%);
            transition: all 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55);
        }
        .notification.show {
            opacity: 1;
            transform: translateX(0);
        }
        .notification.success {
            background-color: #22c55e; /* green-500 */
        }
        .notification.error {
            background-color: #ef4444; /* red-500 */
        }
        /* Yeni Form Stilleri */
        .form-label {
            display: block;
            font-size: 0.875rem; /* text-sm */
            font-weight: 500; /* font-medium */
            color: #374151; /* text-gray-700 */
        }
        .form-input-base {
            margin-top: 0.25rem;
            width: 100%;
            padding: 0.5rem 0.75rem;
            background-color: #f9fafb; /* bg-gray-50 */
            border: 1px solid #d1d5db; /* border-gray-300 */
            border-radius: 0.5rem; /* rounded-lg */
            box-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05); /* shadow-sm */
            color: #111827; /* text-gray-900 */
            placeholder-color: #9ca3af; /* placeholder-gray-400 */
            font-size: 0.875rem; /* text-sm */
        }
        .form-input-base:focus-within, .form-input-base:focus {
            outline: none;
            border-color: #6366f1; /* focus:border-indigo-500 */
            box-shadow: 0 0 0 1px #6366f1; /* focus:ring-1 focus:ring-indigo-500 */
        }
    </style>
</head>
<body class="bg-slate-50 text-gray-800">

    <div id="notification-container"></div>

    <div class="min-h-screen flex flex-col">
      <header class="bg-white/80 backdrop-blur-lg shadow-sm sticky top-0 z-40">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <a href="index.html" class="flex items-center space-x-2">
                     <span class="text-xl font-bold bg-indigo-600 text-white px-2 py-1 rounded-lg">ÜDB</span>
                    <span class="text-lg font-semibold text-gray-700">All Star İş Takip Programı</span>
                </a>
            </div>
        </div>
    </header>

        <main class="flex-grow p-4 md:p-6">
            <div class="space-y-8">
                <div id="form-container" class="bg-white rounded-xl shadow-lg border border-gray-200/80">
                    <button class="collapsible-trigger w-full p-5 text-left font-bold text-lg text-indigo-700 flex justify-between items-center hover:bg-gray-50 rounded-t-xl transition-colors duration-200" data-target="cekim-ekle-form">
                        <span id="form-title" class="flex items-center"><i class="fas fa-plus-circle mr-3 text-indigo-500"></i>Çekim Ekle</span>
                        <i class="fas fa-chevron-down transition-transform duration-300"></i>
                    </button>
                    <div id="cekim-ekle-form" class="collapsible-content">
                        <div class="p-6 border-t border-gray-200">
                             <form id="cek-form" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-6 gap-y-6">
                                <input type="hidden" id="editing-row-index">
                                
                                <div><label class="form-label">Çekim Tarihi</label><input name="cekimTarihi" type="date" class="form-input-base"></div>
                                
                                <div><label class="form-label">Sınav Türü</label>
                                    <select name="sinavTuru" id="sinav-turu-select" class="searchable-select">
                                        <option value="">Seçiniz...</option><option>TYT</option><option>AYT</option><option>LGS</option>
                                    </select>
                                </div>
                                <div><label class="form-label">Anlatım Türü</label>
                                    <select name="anlatimTuru" class="searchable-select">
                                        <option value="">Seçiniz...</option><option>GGÇK</option><option>SORU PRATİĞİ</option><option>TABLET ANLATIM</option><option>AKILLI TAHTA ANLATIM</option><option>ÖZET ANLATIM</option><option>DERECE ANLATIM</option><option>EĞLENCELİ ANLATIM</option><option>İSPATLI ANLATIM</option><option>SÜREÇ İZLEME SINAVI</option><option>ENDENEME</option><option>TÜRKİYE GENELİ DENEME</option><option>TIPKI PROVA</option>
                                    </select>
                                </div>

                                <div><label class="form-label">Video Kodu</label><input name="videoKodu" type="text" placeholder="Video kodunu girin..." class="form-input-base"></div>
                                
                                <div><label class="form-label">Branş</label>
                                    <select name="brans" id="brans-select" class="searchable-select" disabled><option value="">Önce sınav türü seçiniz...</option></select>
                                </div>
                                <div><label class="form-label">Ünite</label>
                                    <select name="unite" id="unite-select" class="searchable-select" disabled><option value="">Önce branş seçiniz...</option></select>
                                </div>

                                <div><label class="form-label">Bölüm</label>
                                    <select name="bolum" class="searchable-select">
                                        <option value="">Seçiniz...</option><option>1.BÖLÜM</option><option>2. BÖLÜM</option><option>3. BÖLÜM</option><option>4. BÖLÜM</option><option>5. BÖLÜM</option><option>6. BÖLÜM</option><option>7. BÖLÜM</option><option>8. BÖLÜM</option><option>9. BÖLÜM</option><option>10. BÖLÜM</option><option>11. BÖLÜM</option><option>12. BÖLÜM</option><option>13. BÖLÜM</option><option>14. BÖLÜM</option><option>15. BÖLÜM</option><option>16. BÖLÜM</option><option>17. BÖLÜM</option><option>18. BÖLÜM</option><option>19. BÖLÜM</option><option>20. BÖLÜM</option><option>21. BÖLÜM</option><option>22. BÖLÜM</option><option>23. BÖLÜM</option><option>24. BÖLÜM</option><option>25. BÖLÜM</option><option>26. BÖLÜM</option><option>27. BÖLÜM</option><option>28. BÖLÜM</option><option>29. BÖLÜM</option><option>30. BÖLÜM</option><option>31. BÖLÜM</option><option>32. BÖLÜM</option><option>33. BÖLÜM</option><option>34. BÖLÜM</option><option>35. BÖLÜM</option><option>36. BÖLÜM</option><option>37. BÖLÜM</option><option>38. BÖLÜM</option><option>39. BÖLÜM</option><option>40. BÖLÜM</option><option>41. BÖLÜM</option><option>42. BÖLÜM</option><option>43. BÖLÜM</option><option>44. BÖLÜM</option><option>45. BÖLÜM</option><option>46. BÖLÜM</option><option>47. BÖLÜM</option><option>48. BÖLÜM</option><option>49. BÖLÜM</option><option>50. BÖLÜM</option><option>MODULE A</option><option>MODULE B</option><option>MODULE C</option><option>MODULE D</option><option>MODULE E</option><option>MODULE F</option><option>MODULE G</option><option>MODULE H</option>
                                    </select>
                                </div>
                                 <div><label class="form-label">Ders</label>
                                    <select name="ders" class="searchable-select">
                                        <option value="">Seçiniz...</option><option>1. DERS</option><option>2. DERS</option><option>3. DERS</option><option>4. DERS</option><option>5. DERS</option><option>6. DERS</option><option>7. DERS</option><option>8. DERS</option><option>9. DERS</option><option>10. DERS</option><option>11. DERS</option><option>12. DERS</option><option>13. DERS</option><option>14. DERS</option><option>15. DERS</option><option>16. DERS</option><option>17. DERS</option><option>18. DERS</option><option>19. DERS</option><option>20. DERS</option><option>21. DERS</option><option>22. DERS</option><option>23. DERS</option><option>24. DERS</option><option>25. DERS</option><option>26. DERS</option><option>27. DERS</option><option>28. DERS</option><option>29. DERS</option><option>30. DERS</option><option>31. DERS</option><option>32. DERS</option><option>33. DERS</option><option>34. DERS</option><option>35. DERS</option><option>36. DERS</option><option>37. DERS</option><option>38. DERS</option><option>39. DERS</option><option>40. DERS</option><option>41. DERS</option><option>42. DERS</option><option>43. DERS</option><option>44. DERS</option><option>45. DERS</option><option>46. DERS</option><option>47. DERS</option><option>48. DERS</option><option>49. DERS</option><option>50. DERS</option><option>SINAV 1</option><option>SINAV 2</option><option>SINAV 3</option><option>SINAV 4</option><option>SINAV 5</option><option>SINAV 6</option><option>SINAV 7</option><option>SINAV 8</option>
                                    </select>
                                </div>
                                <div><label class="form-label">Test Adı</label>
                                    <input name="testAdi" type="text" list="test-adi-list" placeholder="Test adını yazın..." class="form-input-base">
                                    <datalist id="test-adi-list">
                                    </datalist>
                                </div>
                                <div><label class="form-label">Soru Sayısı</label>
                                    <input name="soruSayisi" type="number" min="1" max="50" placeholder="Örn: 8" class="form-input-base">
                                </div>
                                <div><label class="form-label">Anlatıcı Öğretmen</label>
                                    <select name="anlaticiOgretmen" class="searchable-select">
                                        <option value="">Seçiniz...</option><option>Ali Saçan</option><option>Altuğ Güneş</option><option>Anıl Gül</option><option>Bayram Meral</option><option>Betül Büyükkalaycı</option><option>Buğra Arslan</option><option>Burak Onay</option><option>Büşra Altınok</option><option>Cebrail Karaoğlan</option><option>Celal Gündüz</option><option>Deniz Bozkurt</option><option>Didar Baskın</option><option>Emrah Karcı</option><option>Enes Avcı</option><option>Erdal Aydemir</option><option>Erkan Ayrancı</option><option>Erkan Özaslan</option><option>Erkan Tunçer</option><option>Ersen Örenler</option><option>Eyüp Boncuk</option><option>Fatih Demirkaya</option><option>Fatih Sefi</option><option>Görkem Şahin</option><option>Gülhan Şen</option><option>Hale Karataş</option><option>İbrahim Taş</option><option>İbrahim Ulaş Baldemir</option><option>İlayda Gültekin</option><option>İlhan Aslan</option><option>İlyas Güneş</option><option>İsmail Kocabaş</option><option>İsmail Tolga Aktaş</option><option>Kader Altınel</option><option>Kadir Gümüş</option><option>Kadir Sefi</option><option>Kemal Coşkun</option><option>Kenan Kara</option><option>Mahsum Öztürk</option><option>Mehmet Celal Özyıldız</option><option>Mehmet Dural</option><option>Mehmet Durmuş</option><option>Mehmet Özalp</option><option>Melih Akgündüz</option><option>Mesut Uğurdoğan</option><option>Murat Namlı</option><option>Mustafa Öztürk</option><option>Mustafa Yağcı</option><option>Nagihan Damargüç</option><option>Nurtaç Kozak</option><option>Nurten Aydın</option><option>Onur Soğuk</option><option>Önay Çepe</option><option>Özcan Aykın</option><option>Özer Akgümüş</option><option>Öznur Saat Yıldırım</option><option>Rahim Ural</option><option>Recep Üstünel</option><option>Rıdvan Çelebi</option><option>Rümeysa Enise Özdemir</option><option>Rüştü Bayındır</option><option>Salih Yıldırır</option><option>Selim Yüksel</option><option>Semih Akpınar</option><option>Sercan Dural</option><option>Serkan Yeşilkan</option><option>Sinan Aydın</option><option>Şenol Aydın</option><option>Sinem Şentürk</option><option>Şükrü Akkoyun</option><option>Tuncay Ateş</option><option>Umut Öncül</option><option>Uzay Arslantürk</option><option>Veysel Boynueğri</option><option>Yaşar Aslan</option><option>Yavuz Tuna</option><option>Yunus Turan</option>
                                    </select>
                                </div>
                                <div class="lg:col-span-3"><label class="form-label">Not</label><textarea name="not" rows="2" class="form-input-base" placeholder="Eklemek istediğiniz notlar..."></textarea></div>
                                
                                <div class="md:col-span-2 lg:col-span-3 text-right pt-4">
                                    <button id="submit-button" type="submit" class="inline-flex items-center justify-center py-2 px-6 border border-transparent shadow-lg text-sm font-medium rounded-lg text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-all duration-300">
                                        <i id="submit-icon" class="fas fa-check mr-2"></i><span id="submit-text">Kaydet</span>
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-xl shadow-lg border border-gray-200/80">
                    <button class="collapsible-trigger w-full p-5 text-left font-bold text-lg text-indigo-700 flex justify-between items-center hover:bg-gray-50 rounded-t-xl transition-colors duration-200" data-target="liste-tablo-alani">
                         <span class="flex items-center"><i class="fas fa-list-ul mr-3 text-indigo-500"></i>Çekim Listesi</span>
                        <i class="fas fa-chevron-down transition-transform duration-300"></i>
                    </button>
                    <div id="liste-tablo-alani" class="collapsible-content">
                         <div class="p-2 sm:p-4 border-t border-gray-200">
                           <div id="table-container" class="overflow-x-auto">
                                <table id="cekim-tablosu" class="min-w-full border-collapse">
                                    <thead class="bg-gray-100">
                                        <tr>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border border-gray-200">Çekim Tarihi</th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border border-gray-200">Sınav Türü</th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border border-gray-200">Anlatım Türü</th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border border-gray-200">Video Kodu</th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border border-gray-200">Branş</th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border border-gray-200">Ünite</th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border border-gray-200">Bölüm</th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border border-gray-200">Ders</th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border border-gray-200">Test Adı</th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border border-gray-200">Soru Sayısı</th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border border-gray-200">Not</th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border border-gray-200">Anlatıcı Öğretmen</th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border border-gray-200">Yönetmen</th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border border-gray-200">Akademik Dinleyici</th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border border-gray-200">İşlemler</th>
                                        </tr>
                                        <tr>
                                            <td class="p-1 border border-gray-200"><input type="text" placeholder="Filtrele..." class="filter-input w-full text-sm rounded-md border-gray-200 focus:ring-0 focus:border-indigo-300" data-column="0"></td>
                                            <td class="p-1 border border-gray-200"><input type="text" placeholder="Filtrele..." class="filter-input w-full text-sm rounded-md border-gray-200 focus:ring-0 focus:border-indigo-300" data-column="1"></td>
                                            <td class="p-1 border border-gray-200"><input type="text" placeholder="Filtrele..." class="filter-input w-full text-sm rounded-md border-gray-200 focus:ring-0 focus:border-indigo-300" data-column="2"></td>
                                            <td class="p-1 border border-gray-200"><input type="text" placeholder="Filtrele..." class="filter-input w-full text-sm rounded-md border-gray-200 focus:ring-0 focus:border-indigo-300" data-column="3"></td>
                                            <td class="p-1 border border-gray-200"><input type="text" placeholder="Filtrele..." class="filter-input w-full text-sm rounded-md border-gray-200 focus:ring-0 focus:border-indigo-300" data-column="4"></td>
                                            <td class="p-1 border border-gray-200"><input type="text" placeholder="Filtrele..." class="filter-input w-full text-sm rounded-md border-gray-200 focus:ring-0 focus:border-indigo-300" data-column="5"></td>
                                            <td class="p-1 border border-gray-200"><input type="text" placeholder="Filtrele..." class="filter-input w-full text-sm rounded-md border-gray-200 focus:ring-0 focus:border-indigo-300" data-column="6"></td>
                                            <td class="p-1 border border-gray-200"><input type="text" placeholder="Filtrele..." class="filter-input w-full text-sm rounded-md border-gray-200 focus:ring-0 focus:border-indigo-300" data-column="7"></td>
                                            <td class="p-1 border border-gray-200"><input type="text" placeholder="Filtrele..." class="filter-input w-full text-sm rounded-md border-gray-200 focus:ring-0 focus:border-indigo-300" data-column="8"></td>
                                            <td class="p-1 border border-gray-200"><input type="text" placeholder="Filtrele..." class="filter-input w-full text-sm rounded-md border-gray-200 focus:ring-0 focus:border-indigo-300" data-column="9"></td>
                                            <td class="p-1 border border-gray-200"><input type="text" placeholder="Filtrele..." class="filter-input w-full text-sm rounded-md border-gray-200 focus:ring-0 focus:border-indigo-300" data-column="10"></td>
                                            <td class="p-1 border border-gray-200"><input type="text" placeholder="Filtrele..." class="filter-input w-full text-sm rounded-md border-gray-200 focus:ring-0 focus:border-indigo-300" data-column="11"></td>
                                            <td class="p-1 border border-gray-200"><input type="text" placeholder="Filtrele..." class="filter-input w-full text-sm rounded-md border-gray-200 focus:ring-0 focus:border-indigo-300" data-column="12"></td>
                                            <td class="p-1 border border-gray-200"><input type="text" placeholder="Filtrele..." class="filter-input w-full text-sm rounded-md border-gray-200 focus:ring-0 focus:border-indigo-300" data-column="13"></td>
                                            <td class="p-1 border border-gray-200"></td>
                                        </tr>
                                    </thead>
                                    <tbody id="cekim-tablosu-body" class="bg-white divide-y divide-gray-200">
                                    </tbody>
                                </table>
                            </div>
                            <div class="flex items-center justify-between mt-4 p-2 border-t">
                                <span id="record-count" class="text-sm text-gray-600"></span>
                                <div id="pagination-controls" class="flex items-center space-x-1"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    // Sayfalama için değişkenler
    let currentPage = 1;
    const rowsPerPage = 10;

    // Estetik bildirim fonksiyonu
    function showNotification(message, type = 'success') {
        const container = document.getElementById('notification-container');
        if (!container) return;
        const notification = document.createElement('div');
        notification.className = `notification ${type}`;
        
        const iconClass = type === 'success' ? 'fa-check-circle' : 'fa-times-circle';
        notification.innerHTML = `<i class="fas ${iconClass}"></i><span>${message}</span>`;
        
        container.appendChild(notification);
        
        setTimeout(() => {
            notification.classList.add('show');
        }, 10);

        setTimeout(() => {
            notification.classList.remove('show');
            setTimeout(() => {
                if (notification.parentNode === container) {
                    container.removeChild(notification);
                }
            }, 500);
        }, 3000);
    }

    const bransListeleri = {
        'TYT': ['TYT TÜRKÇE', 'TYT MATEMATİK', 'TYT FİZİK', 'TYT KİMYA', 'TYT BİYOLOJİ', 'TYT COĞRAFYA', 'TYT DİN KÜLTÜRÜ', 'TYT-AYT GEOMETRİ', 'TYT-AYT TARİH', 'TYT-AYT FELSEFE'],
        'AYT': ['AYT EDEBİYAT', 'AYT MATEMATİK', 'AYT FİZİK', 'AYT KİMYA', 'AYT BİYOLOJİ', 'AYT COĞRAFYA', 'AYT SOSYOLOJİ-PSİKOLOJİ-MANTIK', 'TYT-AYT GEOMETRİ', 'TYT-AYT TARİH', 'TYT-AYT FELSEFE'],
        'LGS': ['LGS TÜRKÇE', 'LGS MATEMATİK', 'LGS FEN BİLİMLERİ', 'LGS İNKILAP TARİHİ', 'LGS İNGİLİZCE', 'LGS DİN KÜLTÜRÜ']
    };
    const uniteListeleri = {
        'TYT TÜRKÇE': ['SÖZCÜKTE VE SÖZ ÖBEĞİNDE ANLAM', 'CÜMLEDE ANLAM', 'PARAGRAFTA ANLAM', 'SES-YAZIM-NOKTALAMA', 'SÖZCÜK YAPISI', 'İSİM SOYLU SÖZCÜKLER', 'FİİLLER', 'SÖZCÜK GRUPLARI VE CÜMLE BİLGİSİ', 'ANLATIM BOZUKLUKLARI'],
        'TYT MATEMATİK': ['TEMEL KAVRAMLAR', 'BÖLME BÖLÜNEBİLME', 'RASYONEL SAYILAR', 'I VE II BİLİNMEYENLİ DENKLEMLER', 'I VE II BİLİNMEYENLİ EŞİTSİZLİKLER', 'MUTLAK DEĞER', 'ÜSLÜ SAYILAR', 'KÖKLÜ SAYILAR', 'ORAN-ORANTI', 'ÇARPANLARA AYIRMA', 'SAYI PROBLEMLERİ', 'KESİR PROBLEMLERİ', 'YAŞ PROBLEMLERİ', 'YÜZDE PROBLEMLERİ', 'KARIŞIM PROBLEMLERİ', 'HIZ PROBLEMLERİ', 'EMEK PROBLEMLERİ', 'GRAFİK PROBLEMLERİ', 'TANIM VE FORMÜL KULLANABİLME', 'ÖRÜNTÜLÜ SAYI GRUPLARI', 'MANTIK', 'KÜMELER', 'SAYMA OLASILIK', 'GÖRSEL ZEKA'],
        'TYT FİZİK': ['FİZİK BİLİMİNE GİRİŞ', 'MADDE VE ÖZELLİKLERİ', 'HAREKET', 'KUVVET', 'İŞ, GÜÇ VE ENERJİ', 'ISI VE SICAKLIK', 'ELEKTROSTATİK', 'ELEKTRİK', 'MANYETİZMA', 'BASINÇ', 'KALDIRMA KUVVETİ', 'DALGA HAREKETİ VE YAY DALGASI', 'SU DALGALARI', 'SES VE DEPREM DALGALARI', 'AYDINLANMA VE GÖLGE', 'IŞIĞIN YANSIMASI VE DÜZLEM AYNALAR', 'IŞIĞIN YANSIMASI VE KÜRESEL AYNALAR', 'IŞIĞIN KIRILMASI', 'MERCEKLER, PRİZMALAR VE RENK'],
        'TYT KİMYA': ['KİMYA BİLİMİ', 'ATOM VE PERİYODİK SİSTEM', 'KİMYASAL TÜRLER ARASI ETKİLEŞİMLER', 'MADDENİN HALLERİ', 'DOĞA VE KİMYA', 'KİMYANIN TEMEL KANUNLARI VE KİMYASAL HESAPLAMALAR', 'KARIŞIMLAR', 'ASİTLER, BAZLAR VE TUZLAR', 'KİMYA HER YERDE'],
        'TYT BİYOLOJİ': ['YAŞAM BİLİMİ BİYOLOJİ', 'CANLI YAPISINDAKİ BİLEŞİKLER', 'HÜCRE', 'CANLILARIN SINIFLANDIRILMASI', 'CANLI ALEMLERİ', 'HÜCRE BÖLÜNMELERİ VE ÜREME', 'KALITIM', 'EKOSİSTEM EKOLOJİSİ VE GÜNCEL ÇEVRE SORUNLARI'],
        'TYT COĞRAFYA': ["DOĞA, İNSAN VE COĞRAFYA", "DÜNYA'NIN ŞEKLİ HAREKETLERİ", 'COĞRAFİ KONUM', 'HARİTA BİLGİSİ', 'İKLİM BİLGİSİ', 'İÇ VE DIŞ KUVVETLER', 'SU-TOPRAK-BİTKİ', "DÜNYA'DA VE TÜRKİYE'DE NÜFUS", 'EKONOMİK FAALİYETLER', 'BÖLGE KAVRAMI', 'BÖLGELER VE ÜLKELER', 'ÇEVRE VE TOPLUM'],
        'TYT DİN KÜLTÜRÜ': ['BİLGİ VE İNANÇ', 'DİN VE İSLAM', 'İSLAM VE İBADET', 'GENÇLİK VE DEĞERLER', 'GÖNÜL COĞRAFYA', 'ALLAH VE İNSAN İLİŞKİSİ', 'HZ.MUHAMMED (S.A.V)', 'DİN VE HAYAT', 'AHLAKİ TUTUM VE DAVRANİşLAR', 'İSLAM DÜŞÜNCESİNDE İTİKADİ, SİYASİ VE FIKHİ YORUMLAR', 'DÜNYA VE AHİRET', "KUR'AN'A GÖRE HZ.MUHAMMED (S.A.V)", "KUR'AN'DA BAZI KAVRAMLAR", 'İNANÇLA İLGİLİ MESELELER', 'YAHUDİLİK VE HRİSTİYANLIK', 'İSLAM VE BİLİM', "ANADOLU'DA İSLAM", 'İSLAM DÜŞÜNCESİNDE TASAVVUFİ YORUMLAR', 'GÜNCEL DİNİ MESELELER', 'HİNT VE ÇİN DİNLERİ'],
        'TYT-AYT GEOMETRİ': ['AÇILAR', 'ÖZEL ÜÇGENLER', 'ALAN', 'AÇIORTAY', 'KENARORTAY', 'BENZERLİK', 'AÇI-KENAR BAĞINTILARI', 'ÇOKGENLER', 'GENEL DÖRTGENLER VE DELTOİD', 'PARALELKENAR', 'EŞKENAR DÖRTGEN', 'DİKDÖRTGEN', 'KARE', 'YAMUK', 'ÇEMBERDE AÇI', 'ÇEMBERDE UZUNLUK', 'DAİREDE ALAN', 'NOKTA ANALİTİĞİ', 'DOĞRU ANALİTİĞİ', 'DÖNÜŞÜMLER', 'ÇEMBER ANALİTİĞİ', 'KATI CİSİMLER'],
        'TYT-AYT TARİH': ['TARİH VE ZAMAN', 'İNSANLIĞIN İLK DÖNEMLERİ', "ORTA ÇAĞ'DA DÜNYA", 'İLK VE ORTA ÇAĞLARDA TÜRK DÜNYASI', 'İSLAM MEDENİYETİNİN DOĞUŞU', 'TÜRKLERİN İSLAMİYETİ KABULÜ', 'YERLEŞME VE DEVLETLEŞME SÜRECİNDE SELÇUKLU', 'BEYLİKTEN DEVLETE OSMANLI SİYASETİ', 'DEVLETLEŞME SÜRECİNDE SAVAŞÇILAR VE ASKERLER', 'BEYLİKTEN DEVLETE OSMANLI MEDENİYETİ', 'DÜNYA GÜCÜ OSMANLI', 'SULTAN VE OSMANLI MERKEZ TEŞKİLATI', "KLASİK ÇAĞ'DA OSMANLI TOPLUM DÜZENİ", 'DEĞİŞEN DÜNYA DENGELERİ KARŞISINDA OSMANLI', 'DEĞİŞİM ÇAĞINDA AVRUPA VE OSMANLI', 'DEVRİMLER ÇAĞINDA DEĞİŞEN DEVLET-TOPLUM İLİŞKİLERİ', 'ULUSLARARASI İLİŞKİLERDE DENGE STRATEJİSİ', 'XIX. VE XX.YÜZYILDA DEĞİŞEN SOSYO-EKONOMİK HAYAT', 'XX.YÜZYIL BAŞLARINDA OSMANLI DEVLETİ VE DÜNYA', 'MİLLİ MÜCADELE', 'ATATÜRKÇÜLÜK VE TÜRK İNKILABI', 'İKİ SAVAŞ ARASINDAKİ DÖNEMDE TÜRKİYE VE DÜNYA', 'II.DÜNYA SAVAŞI SÜRECİNDE TÜRKİYE VE DÜNYA', 'II.DÜNYA SAVAŞI SONRASINDA TÜRKİYE VE DÜNYA', 'TOPLUMSAL DEVRİM ÇAĞINDA DÜNYA VE TÜRKİYE', '21.YÜZYIL EŞİĞİNDE TÜRKİYE VE DÜNYA'],
        'TYT-AYT FELSEFE': ['FELSEFEYİ TANIMA', 'FELSEFE İLE DÜŞÜNME', 'FELSEFENİN TEMEL KONULARI VE PROBLEMLERİ', 'FELSEFİ OKUMA VE YAZMA', 'MÖ 6.YÜZYIL-MS 2.YÜZYIL FELSEFESİ', 'MS. 2.YÜZYIL-15.YÜZYIL FELSEFESİ', '15.YÜZYIL-17.YÜZYIL FELSEFESİ', '18.YÜZYIL-19.YÜZYIL FELSEFESİ', '20.YÜZYIL FELSEFESİ'],
        'AYT EDEBİYAT': ['TÜRK DİLİ VE EDEBİYATINA GİRİŞ', 'COŞKU VE HEYECANI DİLE GETİREN METİNLER', 'İSLAMİYET ÖNCESİ VE İSLAMİ DÖNEM TÜRK ŞİİRİ', 'TANZİMATTA MİLLİ EDEBİYATA TÜRK ŞİİRİ', 'CUMHURİYET DÖNEMİ TÜRK ŞİİRİ', 'TANZİMATTAN CUMHURİYETE HİKAYE', 'TANZİMATTAN CUMHURİYETE ROMAN', 'TANZİMATTAN CUMHURİYETE TİYATRO', 'BATI EDEBİYATI VE EDEBİ AKIMLAR'],
        'AYT MATEMATİK': ['FONKSİYONLAR', 'POLİNOMLAR', 'II.DERECEDEN DENKLEMLER', 'PARABOL', 'EŞİTSİZLİKLER', 'LOGARİTMA', 'DİZİLER', 'TRİGONOMETRİ', 'LİMİT', 'TÜREV', 'İNTEGRAL'],
        'AYT FİZİK': ['VEKTÖRLER', 'BAĞIL HAREKET', "NEWTON'IN HAREKET YASALARI", 'BİR BOYUTTA SABİT İVMELİ HAREKET', 'BİR VE İKİ BOYUTTA HAREKET', 'ENERJİ', 'İTME VE ÇİZGİSEL MOMENTUM', 'DENGE VE DENGE ŞARTLARI', 'BASİT MAKİNELER', 'ELEKTRİK', 'MANYETİZMA', 'ALTERNATİF AKIM', 'ÇEMBERSEL HAREKET', 'BASİT HARMONİK HAREKET', 'DALGA MEKANİĞİ', 'ATOM FİZİĞİNE GİRİŞ', 'MODERN FİZİK', 'MODERN FİZİĞİN TEKNOLOJİDEKİ UYGULAMALARI'],
        'AYT KİMYA': ['KARBON KİMYASINA GİRİŞ', 'ENERJİ KAYNAKLARI', 'MODERN ATOM TEORİSİ', 'GAZLAR', 'SIVI ÇÖZELTİLER', 'KİMYASAL TEPKİMELERDE HIZ', 'KİMYASAL TEPKİMELERDE ENERJİ', 'KİMYASAL TEPKİMELERDE DENGE', 'KİMYA VE ELEKTRİK'],
        'AYT BİYOLOJİ': ['İNSAN FİZYOLOJİSİ', 'KOMÜNİTE VE POPÜLASYON EKOLOJİSİ', 'GENDEN PROTEİNE', 'CANLILARDA ENERJİ DÖNÜŞÜMLERİ', 'BİTKİ BİYOLOJİSİ'],
        'AYT COĞRAFYA': ['BİYOÇEŞİTLİLİK', 'EKSTREM DOĞA OLAYLARI', 'NÜFUS POLİTİKALARI', 'DOĞAL KAYNAKLAR', "TÜRKİYE'DE EKONOMİ, TARIM, HAYVANCILIK VE ORMANCILIK", "TÜRKİYE'DE MADENLER VE ENERJİ KAYNAKLARI", "TÜRKİYE'DE ULAŞIM, TİCARET VE TURİZM", "TÜRKİYE'NİN İŞLEVSEL BÖLGELERİ VE BÖLGESEL KALKINMA PROJELERİ", 'İLK KÜLTÜR MERKEZLERİ', 'DOĞAL KAYNAKLARIN ETKİLERİ, ÜLKELER ARASI ETKİLEŞİM', 'ULUSLARARASI ÖRGÜTLER', 'ÇEVRE VE TOPLUM'],
        'AYT SOSYOLOJİ-PSİKOLOJİ-MANTIK': ['SOSYOLOJİYE GİRİŞ', 'BİREY VE TOPLUM', 'TOPLUMSAL YAPI', 'TOPLUMSAL DEĞİŞME VE GELİŞME', 'TOPLUM VE KÜLTÜR', 'TOPLUMSAL KURUMLAR', 'PSİKOLOJİ BİLİMİNİ TANIYALIM', 'PSKİLOJİNİN TEMEL SÜREÇLERİ', 'ÖĞRENME-BELLEK-DÜŞÜNME', 'RUH SAĞLIĞININ TEMELLERİ', 'MANTIĞA GİRİŞ', 'KLASİK MANTIK', 'MANTIK VE DİL', 'SEMBOLİK MANTIK'],
        'LGS TÜRKÇE': ['SÖZCÜKTE ANLAM', 'CÜMLEDE ANLAM', 'METİNDE ANLAM', 'SÖZEL MANTIK', 'FİİLİMSİLER', 'CÜMLENİN ÖGELERİ', 'FİİİLDE ÇATI', 'CÜMLE TÜRLERİ', 'ANLATIM BOZUKLUKLARI', 'YAZIM KURALLARI', 'NOKTALAMA İŞARETLERİ'],
        'LGS MATEMATİK': ['ÇARPANLAR VE KATLAR', 'ÜSLÜ İFADELER', 'KAREKÖKLÜ İFADELER', 'VERİ ANALİZİ', 'OLASILIK', 'CEBİRSEL İFADELER', 'DENKLEMLER', 'EŞİTSİZLİKLER', 'ÜÇGENLER', 'BENZERLİK', 'DÖNÜŞÜM GEOMETRİSİ', 'GEOMETRİK CİSİMLER'],
        'LGS İNKILAP TARİHİ': ['BİR KAHRAMAN DOĞUYOR', 'MİLLİ UYANIŞ', 'MİLLİ BİR DESTAN', 'ATATÜRKÇÜLÜK VE ÇAĞDAŞLAŞAN TÜRKİYE', 'DEMOKRATİKLEŞME ÇABALARI', 'ATATÜRK DÖNEMİ DIŞ POLİTİKA', "ATATÜRK'ÜN ÖLÜMÜ VE SONRASI"],
        'LGS FEN BİLİMLERİ': ['MEVSİMLER VE İKLİM', 'DNA VE GENETİK KOD', 'BASINÇ', 'MADDE VE ENDÜSTRİ', 'BASİT MAKİNELER', 'ENERJİ DÖNÜŞÜMLERİ', 'ELEKTRİK YÜKLERİ'],
        'LGS DİN KÜLTÜRÜ': ['KAZA VE KADER İNANCI', 'ZEKAT VE SADAKA', 'DİN VE HAYAT', "HZ.MUHAMMED'İN ÖRNEKLİĞİ", 'KUR\'AN-I KERİM VE ÖZELLİKLERİ'],
        'LGS İNGİLİZCE': ['FRIENDSHIP', 'TEEN LIFE', 'IN THE KITCHEN', 'ON THE PHONE', 'THE INTERNET', 'ADVENTURES', 'TOURISM', 'CHORES', 'SCIENCE', 'NATURAL FORCES'],
    };
    const sinavTuruSelect = document.getElementById('sinav-turu-select');
    const bransSelect = document.getElementById('brans-select');
    const uniteSelect = document.getElementById('unite-select');
    const cekForm = document.getElementById('cek-form');
    const tableBody = document.getElementById('cekim-tablosu-body');
    const recordCountEl = document.getElementById('record-count');
    const paginationControlsEl = document.getElementById('pagination-controls');
    const filterInputs = document.querySelectorAll('.filter-input');
    function createSearchableDropdown(selectElement) {
        const container = document.createElement('div');
        container.className = 'searchable-select-container relative';
        selectElement.parentNode.insertBefore(container, selectElement);
        selectElement.style.display = 'none';
        container.appendChild(selectElement);
        const displayButton = document.createElement('button');
        displayButton.type = 'button';
        displayButton.className = 'form-input-base text-left flex justify-between items-center';
        const displaySpan = document.createElement('span');
        displaySpan.className = 'truncate';
        displayButton.appendChild(displaySpan);
        const icon = document.createElement('i');
        icon.className = 'fas fa-chevron-down text-gray-400';
        displayButton.appendChild(icon);
        container.appendChild(displayButton);
        const dropdown = document.createElement('div');
        dropdown.className = 'searchable-select-dropdown hidden bg-white border border-gray-300 rounded-lg mt-1 shadow-lg';
        const searchInput = document.createElement('input');
        searchInput.type = 'text';
        searchInput.placeholder = 'Ara...';
        searchInput.className = 'block w-full p-2 border-b border-gray-200 focus:outline-none';
        dropdown.appendChild(searchInput);
        const optionsList = document.createElement('div');
        optionsList.className = 'p-1';
        dropdown.appendChild(optionsList);
        container.appendChild(dropdown);
        const updateOptions = () => {
            optionsList.innerHTML = '';
            Array.from(selectElement.options).forEach(option => {
                if (option.value === "" && (option.textContent.includes('Seçiniz') || option.textContent.includes('Önce'))) return;
                const optionDiv = document.createElement('div');
                optionDiv.textContent = option.textContent;
                optionDiv.dataset.value = option.value;
                optionDiv.className = 'p-2 cursor-pointer hover:bg-indigo-100 rounded text-sm';
                optionDiv.addEventListener('click', () => {
                    selectElement.value = option.value;
                    displaySpan.textContent = option.textContent;
                    displaySpan.classList.remove('text-gray-400');
                    dropdown.classList.add('hidden');
                    selectElement.dispatchEvent(new Event('change'));
                });
                optionsList.appendChild(optionDiv);
            });
            const selectedOption = selectElement.querySelector(`option[value="${selectElement.value}"]`) || selectElement.options[0];
            if (selectedOption) {
                displaySpan.textContent = selectedOption.textContent;
                if(selectedOption.value === "" || selectElement.disabled) displaySpan.classList.add('text-gray-400');
                else displaySpan.classList.remove('text-gray-400');
            }
        };
        searchInput.addEventListener('input', () => {
            const filter = searchInput.value.toLowerCase();
            optionsList.querySelectorAll('div').forEach(optionDiv => {
                const text = optionDiv.textContent.toLowerCase();
                optionDiv.style.display = text.includes(filter) ? '' : 'none';
            });
        });
        displayButton.addEventListener('click', (e) => {
            e.stopPropagation();
             if(selectElement.disabled) return;
            document.querySelectorAll('.searchable-select-dropdown').forEach(d => {
                if(d !== dropdown) d.classList.add('hidden');
            });
            dropdown.classList.toggle('hidden');
            if(!dropdown.classList.contains('hidden')) {
                searchInput.value = '';
                searchInput.dispatchEvent(new Event('input'));
                searchInput.focus();
            }
        });
        selectElement.updateDropdown = updateOptions;
        updateOptions();
    }
    document.querySelectorAll('.searchable-select').forEach(createSearchableDropdown);
    document.addEventListener('click', () => {
        document.querySelectorAll('.searchable-select-dropdown').forEach(d => d.classList.add('hidden'));
    });
    const updateSelectDisplay = (selectElement) => {
        if(selectElement.updateDropdown) {
           selectElement.updateDropdown();
        }
    }
    sinavTuruSelect.addEventListener('change', () => {
        const secilenSinavTuru = sinavTuruSelect.value;
        const branslar = bransListeleri[secilenSinavTuru] || [];
        bransSelect.innerHTML = '<option value="" selected>Seçiniz...</option>';
        uniteSelect.innerHTML = '<option value="" selected>Önce branş seçiniz...</option>';
        bransSelect.disabled = branslar.length === 0;
        uniteSelect.disabled = true;
        branslar.forEach(brans => {
            const option = document.createElement('option');
            option.value = brans;
            option.textContent = brans;
            bransSelect.appendChild(option);
        });
        updateSelectDisplay(bransSelect);
        updateSelectDisplay(uniteSelect);
    });
    bransSelect.addEventListener('change', () => {
        const secilenBrans = bransSelect.value;
        const uniteler = uniteListeleri[secilenBrans] || [];
        uniteSelect.innerHTML = '<option value="" selected>Seçiniz...</option>';
        uniteSelect.disabled = uniteler.length === 0;
        uniteler.forEach(unite => {
            const option = document.createElement('option');
            option.value = unite;
            option.textContent = unite;
            uniteSelect.appendChild(option);
        });
        updateSelectDisplay(uniteSelect);
    });
    function updateCollapsibleHeight(contentElement) {
        if (contentElement.style.maxHeight && contentElement.style.maxHeight !== '0px') {
            requestAnimationFrame(() => {
                contentElement.style.maxHeight = contentElement.scrollHeight + 'px';
            });
        }
    }
    const triggers = document.querySelectorAll('.collapsible-trigger');
    triggers.forEach(trigger => {
        trigger.addEventListener('click', () => {
            const content = document.getElementById(trigger.dataset.target);
            const icon = trigger.querySelector('i.fas');
            if (content.style.maxHeight && content.style.maxHeight !== '0px'){
                content.style.maxHeight = null;
                icon.classList.remove('rotate-180');
            } else {
                content.style.maxHeight = content.scrollHeight + "px";
                icon.classList.add('rotate-180');
            } 
        });
    });
    filterInputs.forEach(input => {
        input.addEventListener('keyup', () => {
            currentPage = 1;
            renderTable();
        });
    });
    cekForm.addEventListener('submit', function(e) {
        e.preventDefault();
        const editingId = document.getElementById('editing-row-index').value;
        const formData = new FormData(cekForm);
        const data = Object.fromEntries(formData.entries());
        let cekimler = JSON.parse(localStorage.getItem('cekimListesi')) || [];
        if (editingId) {
            const cekimIndex = cekimler.findIndex(c => c.id === editingId);
            if (cekimIndex > -1) {
                const mevcutCekim = cekimler[cekimIndex];
                cekimler[cekimIndex] = { ...mevcutCekim, ...data, id: editingId };
                showNotification('Kayıt başarıyla güncellendi!');
            }
        } else {
            const newCekim = { 
                ...data, 
                id: crypto.randomUUID(), 
                yonetmen: '', 
                akademikDinleyici: '' 
            };
            cekimler.push(newCekim);
            showNotification('Kayıt başarıyla eklendi!');
        }
        localStorage.setItem('cekimListesi', JSON.stringify(cekimler));
        currentPage = 1;
        renderTable(true);
        resetForm();
    });
    function displayPage(items) {
        tableBody.innerHTML = '';
        const start = (currentPage - 1) * rowsPerPage;
        const end = start + rowsPerPage;
        const paginatedItems = items.slice(start, end);
        paginatedItems.forEach(data => {
            const newRow = tableBody.insertRow();
            newRow.className = 'hover:bg-indigo-50 transition-colors duration-200';
            const date = new Date(data.cekimTarihi + 'T00:00:00');
            const formattedDate = data.cekimTarihi ? `${date.getDate().toString().padStart(2, '0')}/${(date.getMonth() + 1).toString().padStart(2, '0')}/${date.getFullYear()}` : '';
            newRow.innerHTML = `
                <td class="px-4 py-4 whitespace-nowrap text-sm text-center align-middle border border-gray-200">${formattedDate}</td>
                <td class="px-4 py-4 whitespace-nowrap text-sm text-center align-middle border border-gray-200">${data.sinavTuru || ''}</td>
                <td class="px-4 py-4 whitespace-nowrap text-sm text-center align-middle border border-gray-200">${data.anlatimTuru || ''}</td>
                <td class="px-4 py-4 whitespace-nowrap text-sm text-center align-middle border border-gray-200">${data.videoKodu || ''}</td>
                <td class="px-4 py-4 whitespace-nowrap text-sm text-center align-middle border border-gray-200">${data.brans || ''}</td>
                <td class="px-4 py-4 whitespace-nowrap text-sm text-center align-middle border border-gray-200">${data.unite || ''}</td>
                <td class="px-4 py-4 whitespace-nowrap text-sm text-center align-middle border border-gray-200">${data.bolum || ''}</td>
                <td class="px-4 py-4 whitespace-nowrap text-sm text-center align-middle border border-gray-200">${data.ders || ''}</td>
                <td class="px-4 py-4 whitespace-nowrap text-sm text-center align-middle border border-gray-200">${data.testAdi || ''}</td>
                <td class="px-4 py-4 whitespace-nowrap text-sm text-center align-middle border border-gray-200">${data.soruSayisi || ''}</td>
                <td class="px-4 py-4 text-sm text-center align-middle border border-gray-200"><div class="max-w-[150px] mx-auto whitespace-nowrap overflow-hidden text-ellipsis" title="${data.not || ''}">${(data.not || '').substring(0,25)}${(data.not || '').length > 25 ? '...' : ''}</div></td>
                <td class="px-4 py-4 whitespace-nowrap text-sm text-center align-middle border border-gray-200">${data.anlaticiOgretmen || ''}</td>
                <td class="px-4 py-4 whitespace-nowrap text-sm text-center align-middle border border-gray-200">${data.yonetmen || ''}</td>
                <td class="px-4 py-4 whitespace-nowrap text-sm text-center align-middle border border-gray-200">${data.akademikDinleyici || ''}</td>
                <td class="px-4 py-4 whitespace-nowrap text-sm font-medium text-center align-middle border border-gray-200">
                    <div class="flex items-center justify-center space-x-2">
                        <button title="Düzenle" class="text-indigo-600 hover:text-indigo-900 p-2 rounded-full hover:bg-indigo-100 transition-colors duration-200 edit-row" data-id="${data.id}"><i class="fas fa-edit"></i></button>
                        <button title="Sil" class="text-red-600 hover:text-red-900 p-2 rounded-full hover:bg-red-100 transition-colors duration-200 delete-row" data-id="${data.id}"><i class="fas fa-trash"></i></button>
                    </div>
                </td>
            `;
        });
    }
    function setupPagination(items) {
        paginationControlsEl.innerHTML = '';
        const pageCount = Math.ceil(items.length / rowsPerPage);
        if (pageCount === 0) return;
        if (pageCount === 1) {
             const btn = document.createElement('button');
            btn.innerText = 1;
            btn.className = 'pagination-button active';
            btn.disabled = true;
            paginationControlsEl.appendChild(btn);
            return;
        }
        const prevButton = document.createElement('button');
        prevButton.innerHTML = `<i class="fas fa-chevron-left"></i>`;
        prevButton.className = 'pagination-button';
        prevButton.disabled = currentPage === 1;
        prevButton.addEventListener('click', () => {
            if (currentPage > 1) {
                currentPage--;
                renderTable();
            }
        });
        paginationControlsEl.appendChild(prevButton);
        for (let i = 1; i <= pageCount; i++) {
            const btn = document.createElement('button');
            btn.innerText = i;
            btn.className = 'pagination-button';
            if (i === currentPage) {
                btn.classList.add('active');
            }
            btn.addEventListener('click', () => {
                currentPage = i;
                renderTable();
            });
            paginationControlsEl.appendChild(btn);
        }
        const nextButton = document.createElement('button');
        nextButton.innerHTML = `<i class="fas fa-chevron-right"></i>`;
        nextButton.className = 'pagination-button';
        nextButton.disabled = currentPage === pageCount;
        nextButton.addEventListener('click', () => {
            if (currentPage < pageCount) {
                currentPage++;
                renderTable();
            }
        });
        paginationControlsEl.appendChild(nextButton);
    }
    function renderTable(clearFilters = false) {
        if (clearFilters) {
            filterInputs.forEach(input => input.value = '');
        }
        let cekimler = JSON.parse(localStorage.getItem('cekimListesi')) || [];
        const filters = Array.from(filterInputs).map(i => i.value.toLowerCase());
        const filteredCekimler = cekimler.filter(row => {
            return filters.every((filter, index) => {
                if (!filter) return true;
                const columns = [
                    row.cekimTarihi, row.sinavTuru, row.anlatimTuru, row.videoKodu,
                    row.brans, row.unite, row.bolum, row.ders, row.testAdi,
                    row.soruSayisi, row.not, row.anlaticiOgretmen, row.yonetmen, row.akademikDinleyici
                ];
                let cellValue = '';
                if (index === 0 && row.cekimTarihi) {
                    const date = new Date(row.cekimTarihi + 'T00:00:00');
                    cellValue = `${date.getDate().toString().padStart(2, '0')}/${(date.getMonth() + 1).toString().padStart(2, '0')}/${date.getFullYear()}`;
                } else {
                    cellValue = columns[index] ? columns[index].toString().toLowerCase() : '';
                }
                return cellValue.includes(filter);
            });
        });
        filteredCekimler.sort((a, b) => new Date(b.cekimTarihi) - new Date(a.cekimTarihi));
        recordCountEl.textContent = `Toplam ${filteredCekimler.length} kayıt bulundu.`;
        displayPage(filteredCekimler);
        setupPagination(filteredCekimler);
        updateCollapsibleHeight(document.getElementById('liste-tablo-alani'));
        updateCollapsibleHeight(document.getElementById('cekim-ekle-form'));
    }
    function resetForm() {
        cekForm.reset();
        document.getElementById('editing-row-index').value = '';
        document.getElementById('form-title').innerHTML = '<i class="fas fa-plus-circle mr-3 text-indigo-500"></i>Çekim Ekle';
        document.getElementById('submit-text').textContent = 'Kaydet';
        document.getElementById('submit-icon').className = 'fas fa-check mr-2';
        cekForm.querySelectorAll('.searchable-select').forEach(sel => {
            sel.value = '';
            updateSelectDisplay(sel);
        });
        bransSelect.disabled = true;
        uniteSelect.disabled = true;
        bransSelect.innerHTML = '<option value="">Önce sınav türü seçiniz...</option>';
        uniteSelect.innerHTML = '<option value="">Önce branş seçiniz...</option>';
        updateSelectDisplay(bransSelect);
        updateSelectDisplay(uniteSelect);
    }
    tableBody.addEventListener('click', function(e) {
        const deleteButton = e.target.closest('.delete-row');
        const editButton = e.target.closest('.edit-row');
        if (deleteButton) {
            e.preventDefault();
            const id = deleteButton.dataset.id;
            if (confirm('Bu kaydı silmek istediğinizden emin misiniz?')) {
                let cekimler = JSON.parse(localStorage.getItem('cekimListesi')) || [];
                cekimler = cekimler.filter(c => c.id !== id);
                localStorage.setItem('cekimListesi', JSON.stringify(cekimler));
                renderTable();
                showNotification('Kayıt başarıyla silindi.', 'error');
            }
        }
        if (editButton) {
            e.preventDefault();
            const id = editButton.dataset.id;
            const cekimler = JSON.parse(localStorage.getItem('cekimListesi')) || [];
            const cekim = cekimler.find(c => c.id === id);
            if (!cekim) return;
            cekForm.elements.cekimTarihi.value = cekim.cekimTarihi;
            cekForm.elements.videoKodu.value = cekim.videoKodu;
            cekForm.elements.testAdi.value = cekim.testAdi;
            cekForm.elements.soruSayisi.value = cekim.soruSayisi;
            cekForm.elements.not.value = cekim.not;
            function setSelectValue(selectName, value) {
                const select = cekForm.elements[selectName];
                select.value = value;
                select.dispatchEvent(new Event('change'));
                updateSelectDisplay(select);
            }
            setSelectValue('sinavTuru', cekim.sinavTuru);
            setTimeout(() => {
                setSelectValue('brans', cekim.brans);
                setTimeout(() => {
                    setSelectValue('unite', cekim.unite);
                }, 50);
            }, 50);
            setSelectValue('anlatimTuru', cekim.anlatimTuru);
            setSelectValue('bolum', cekim.bolum);
            setSelectValue('ders', cekim.ders);
            setSelectValue('anlaticiOgretmen', cekim.anlaticiOgretmen);
            document.getElementById('editing-row-index').value = id;
            document.getElementById('form-title').innerHTML = '<i class="fas fa-edit mr-3 text-indigo-500"></i>Kaydı Düzenle';
            document.getElementById('submit-text').textContent = 'Güncelle';
            document.getElementById('submit-icon').className = 'fas fa-sync-alt mr-2';
            const formContent = document.getElementById('cekim-ekle-form');
            if (!formContent.style.maxHeight || formContent.style.maxHeight === '0px') {
                formContent.parentElement.querySelector('.collapsible-trigger').click();
            }
            document.getElementById('form-container').scrollIntoView({ behavior: 'smooth' });
        }
    });

    document.querySelectorAll('.collapsible-trigger').forEach(trigger => {
        const content = document.getElementById(trigger.dataset.target);
        const icon = trigger.querySelector('i.fas');
        if (content && icon) {
            setTimeout(() => {
                content.style.maxHeight = content.scrollHeight + "px";
                icon.classList.add('rotate-180');
            }, 100);
        }
    });

    renderTable(); 
    window.addEventListener('storage', renderTable);
});
</script>

</body>
</html>
